{% extends 'layouts/base.html' %}
{% load mathfilters %}
{% block stylesheets %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
{% endblock stylesheets %}
{% block content %}
<!-- TABLE -->
<table class="table table-striped" id="projects">
    <thead>
    <tr>
        <th scope="col">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th scope="col">–ö–ª–∏–µ–Ω—Ç</th>
        <th scope="col">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</th>
        <th scope="col">–°–µ—Ä–≤–µ—Ä</th>
        <th scope="col">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</th>
        <th scope="col">$ –ü–æ–¥–¥–µ—Ä–∂–∫–∏</th>
        <th scope="col">–û–ø–ª–∞—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏</th>
        <th scope="col">$ –ê—Ä–µ–Ω–¥—ã</th>
        <th scope="col">–û–ø–ª–∞—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞</th>
        <th scope="col">–¶–µ–Ω–∞</th>
        <th scope="col">–û–ø–ª–∞—á–µ–Ω–æ</th>
        <th scope="col">–î–æ–ø.<span class="position-absolute translate-middle badge rounded-pill bg-secondary ">
                <a href="/create_support_payment" style="color: black">+</a>
                  </span></th>
        <th scope="col">–î–æ–ª–≥</th>
        <th scope="col">#</th>
    </tr>
    </thead>

    {% for project in projects %}
        <div class="container "></div>

        <tbody>
        <tr>
            {% if project.status %}
                <th class="text-success">{{ project.name }}<a href="/project_details/{{ project.id }}"><br><i
                        class="fa-solid fa-pen-to-square"></i></a></th>
            {% else %}
                <td class="text-danger">{{ project.name }}<a href="/project_details/{{ project.id }}"><br><i
                        class="fa-solid fa-pen-to-square"></i></a></td>
            {% endif %}
            <td>{{ project.client }}</td>
            <td>{{ project.platform }}</td>
            <td><a href="{{ project.server }}">{{ project.server }}</a>
                {% if project.is_server_mine %}<br>
                    –ú–æ–π —Å–µ—Ä–≤–µ—Ä üíª{% else %}{% endif %}</td>
            <td>{% if project.support %}–î–∞{% else %}-{% endif %}</td>
            <td>{% if project.support_price %}{{ project.support_price }}{% else %}-{% endif %}</td>
            <td>{% if project.support_next_payment_date %}{{ project.support_next_payment_date }}{% else %}
                -{% endif %}</td>
            <td>{% if project.rent_price %}{{ project.rent_price }}{% else %}-{% endif %}</td>
            <td>{% if project.rent_next_payment_date %}{{ project.rent_next_payment_date }}{% else %}
                -{% endif %}</td>
            <td>{{ project.project_price }}</td>
            <td>{{ project.income }}</td>
            <td class="position-relative ">
                <div class="dropdown">
                    <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton1"
                            data-bs-toggle="dropdown" aria-expanded="false">
                        $
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                        {% for payment in support_payments %}
                            {% if payment.project_id == project.id %}
                                <li><a class="dropdown-item" href="/support_payment_details/{{ payment.id }}">{{ payment.price }} | {{ payment.payment_date|date }}</a></li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </div>

            </td>
            <td>{{ project.project_price|sub:project.income }}</td>
            <td>
                <a href="/update_project/{{ project.id }}"><i class="fa-regular fa-pen-to-square"></i></a>
                <a href="/delete_project/{{ project.id }}"><i class="fa-solid fa-trash"></i></a>
            </td>
        </tr>
        </tbody>
    {% endfor %}
</table>
<h1>–û–±—â–∏–π –î–æ—Ö–æ–¥: {{ total_income }}—Ä</h1>
{% endblock content %}